<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  </head>
  <style>
    body {
      background-color: ivory;
    }
    #canvas {
      border: 1px solid red;
      background-repeat: no-repeat;
      background-position: center;
      background-size: cover;
      background-image: url('./new-white-logo-wide.jpeg');
    }
  </style>
  <body>
    <h4>Drag to create polyline then click a redraw button below.</h4>
    <button id=fast>Fast Redraw</button>
    <br>
    <canvas id="canvas" width=512 height=512></canvas>
    <script type="text/javascript">
      // var points2 = '[{"x":4,"y":303},{"x":8,"y":303},{"x":11,"y":303},{"x":20,"y":303},{"x":31,"y":303},{"x":43,"y":303},{"x":51,"y":303},{"x":59,"y":302},{"x":66,"y":300},{"x":73,"y":298},{"x":78,"y":294},{"x":85,"y":290},{"x":92,"y":286},{"x":97,"y":283},{"x":104,"y":280},{"x":111,"y":276},{"x":117,"y":272},{"x":124,"y":268},{"x":130,"y":263},{"x":136,"y":256},{"x":143,"y":250},{"x":151,"y":242},{"x":155,"y":236},{"x":160,"y":230},{"x":166,"y":224},{"x":172,"y":219},{"x":179,"y":213},{"x":183,"y":206},{"x":188,"y":200},{"x":193,"y":193},{"x":198,"y":185},{"x":202,"y":179},{"x":206,"y":175},{"x":211,"y":168},{"x":216,"y":159},{"x":221,"y":151},{"x":225,"y":145},{"x":228,"y":138},{"x":232,"y":130},{"x":235,"y":121},{"x":239,"y":110},{"x":241,"y":102},{"x":246,"y":93},{"x":250,"y":85},{"x":253,"y":76},{"x":254,"y":70},{"x":254,"y":62},{"x":253,"y":52},{"x":252,"y":44},{"x":251,"y":36},{"x":251,"y":28},{"x":249,"y":22},{"x":246,"y":18},{"x":239,"y":17},{"x":232,"y":16},{"x":225,"y":16},{"x":216,"y":22},{"x":210,"y":28},{"x":205,"y":35},{"x":200,"y":47},{"x":196,"y":56},{"x":190,"y":68},{"x":186,"y":79},{"x":182,"y":93},{"x":177,"y":107},{"x":173,"y":120},{"x":167,"y":136},{"x":165,"y":146},{"x":161,"y":161},{"x":157,"y":175},{"x":155,"y":193},{"x":154,"y":214},{"x":154,"y":228},{"x":154,"y":242},{"x":154,"y":254},{"x":154,"y":271},{"x":154,"y":286},{"x":154,"y":298},{"x":154,"y":311},{"x":154,"y":320},{"x":157,"y":329},{"x":159,"y":336},{"x":162,"y":341},{"x":168,"y":350},{"x":174,"y":357},{"x":180,"y":360},{"x":188,"y":359},{"x":194,"y":354},{"x":198,"y":350},{"x":203,"y":344},{"x":209,"y":336},{"x":215,"y":331},{"x":225,"y":321},{"x":230,"y":314},{"x":237,"y":303},{"x":246,"y":288},{"x":253,"y":275},{"x":260,"y":260},{"x":266,"y":245},{"x":270,"y":233},{"x":273,"y":221},{"x":275,"y":211},{"x":276,"y":202},{"x":278,"y":196},{"x":279,"y":218},{"x":279,"y":241},{"x":277,"y":258},{"x":275,"y":275},{"x":272,"y":291},{"x":268,"y":307},{"x":263,"y":329},{"x":259,"y":345},{"x":256,"y":361},{"x":254,"y":376},{"x":254,"y":395},{"x":254,"y":412},{"x":254,"y":433},{"x":254,"y":449},{"x":254,"y":464},{"x":254,"y":475},{"x":254,"y":484},{"x":254,"y":491},{"x":256,"y":498},{"x":257,"y":506},{"x":258,"y":486},{"x":259,"y":467},{"x":260,"y":452},{"x":260,"y":435},{"x":260,"y":422},{"x":261,"y":411},{"x":261,"y":400},{"x":262,"y":394},{"x":262,"y":386},{"x":262,"y":377},{"x":262,"y":367},{"x":264,"y":354},{"x":267,"y":344},{"x":269,"y":331},{"x":272,"y":318},{"x":276,"y":309},{"x":278,"y":300},{"x":282,"y":292},{"x":287,"y":283},{"x":291,"y":275},{"x":296,"y":268},{"x":300,"y":262},{"x":305,"y":256},{"x":310,"y":252},{"x":318,"y":244},{"x":324,"y":239},{"x":330,"y":235},{"x":337,"y":231},{"x":345,"y":229},{"x":352,"y":228},{"x":356,"y":235},{"x":360,"y":244},{"x":367,"y":254},{"x":367,"y":264},{"x":367,"y":274},{"x":368,"y":279},{"x":366,"y":283},{"x":360,"y":296},{"x":358,"y":307},{"x":355,"y":317},{"x":352,"y":329},{"x":347,"y":334},{"x":345,"y":338},{"x":333,"y":346},{"x":326,"y":353},{"x":319,"y":356},{"x":311,"y":357},{"x":304,"y":354},{"x":300,"y":347},{"x":299,"y":339},{"x":299,"y":331},{"x":305,"y":324},{"x":310,"y":319},{"x":315,"y":313},{"x":325,"y":307},{"x":334,"y":303},{"x":341,"y":301},{"x":349,"y":297},{"x":359,"y":295},{"x":369,"y":292},{"x":377,"y":290},{"x":383,"y":289},{"x":391,"y":288},{"x":398,"y":288},{"x":405,"y":288},{"x":412,"y":288},{"x":419,"y":288},{"x":428,"y":288},{"x":439,"y":290},{"x":448,"y":291},{"x":458,"y":293},{"x":466,"y":295},{"x":473,"y":298},{"x":480,"y":300},{"x":486,"y":301},{"x":493,"y":302},{"x":500,"y":306}]';
      var points2 = '[]';
      var points2 = '[{"x":8,"y":281},{"x":11,"y":276},{"x":16,"y":272},{"x":21,"y":269},{"x":27,"y":266},{"x":39,"y":263},{"x":47,"y":260},{"x":57,"y":258},{"x":70,"y":256},{"x":86,"y":256},{"x":99,"y":255},{"x":109,"y":254},{"x":120,"y":254},{"x":131,"y":253},{"x":144,"y":251},{"x":153,"y":249},{"x":161,"y":248},{"x":169,"y":247},{"x":177,"y":244},{"x":192,"y":237},{"x":205,"y":229},{"x":217,"y":220},{"x":227,"y":213},{"x":239,"y":203},{"x":251,"y":191},{"x":260,"y":173},{"x":267,"y":156},{"x":273,"y":143},{"x":276,"y":130},{"x":276,"y":116},{"x":275,"y":107},{"x":272,"y":99},{"x":269,"y":92},{"x":251,"y":96},{"x":234,"y":110},{"x":228,"y":122},{"x":224,"y":133},{"x":222,"y":145},{"x":221,"y":158},{"x":220,"y":171},{"x":220,"y":185},{"x":220,"y":200},{"x":219,"y":211},{"x":218,"y":223},{"x":218,"y":232},{"x":218,"y":242},{"x":219,"y":252},{"x":219,"y":262},{"x":219,"y":272},{"x":221,"y":279},{"x":223,"y":285},{"x":227,"y":290},{"x":230,"y":291},{"x":237,"y":287},{"x":245,"y":276},{"x":255,"y":257},{"x":264,"y":240},{"x":272,"y":227},{"x":278,"y":216},{"x":283,"y":208},{"x":286,"y":203},{"x":280,"y":216},{"x":273,"y":242},{"x":273,"y":265},{"x":273,"y":287},{"x":273,"y":303},{"x":272,"y":312},{"x":272,"y":325},{"x":272,"y":342},{"x":272,"y":355},{"x":273,"y":366},{"x":273,"y":379},{"x":273,"y":388},{"x":272,"y":393},{"x":271,"y":398},{"x":263,"y":381},{"x":254,"y":345},{"x":254,"y":331},{"x":259,"y":314},{"x":267,"y":299},{"x":275,"y":282},{"x":281,"y":270},{"x":285,"y":259},{"x":290,"y":249},{"x":295,"y":237},{"x":302,"y":225},{"x":309,"y":219},{"x":313,"y":217},{"x":318,"y":216},{"x":326,"y":218},{"x":332,"y":222},{"x":336,"y":229},{"x":339,"y":236},{"x":340,"y":247},{"x":339,"y":259},{"x":336,"y":271},{"x":332,"y":283},{"x":325,"y":293},{"x":317,"y":293},{"x":309,"y":288},{"x":311,"y":272},{"x":324,"y":263},{"x":342,"y":257},{"x":360,"y":253},{"x":372,"y":252},{"x":392,"y":252},{"x":414,"y":254},{"x":432,"y":256},{"x":445,"y":256},{"x":457,"y":256},{"x":471,"y":256},{"x":488,"y":254},{"x":498,"y":252},{"x":504,"y":251},{"x":488,"y":255},{"x":468,"y":256},{"x":443,"y":259},{"x":421,"y":259},{"x":409,"y":260},{"x":405,"y":258},{"x":402,"y":246},{"x":402,"y":236},{"x":401,"y":225},{"x":398,"y":212},{"x":392,"y":200},{"x":388,"y":191},{"x":382,"y":178},{"x":376,"y":165},{"x":368,"y":155},{"x":356,"y":145},{"x":342,"y":137},{"x":320,"y":128},{"x":309,"y":125},{"x":294,"y":121},{"x":279,"y":120},{"x":260,"y":120},{"x":241,"y":120},{"x":228,"y":122},{"x":209,"y":126},{"x":196,"y":132},{"x":180,"y":139},{"x":169,"y":148},{"x":154,"y":162},{"x":145,"y":178},{"x":139,"y":197},{"x":133,"y":218},{"x":130,"y":243},{"x":127,"y":260},{"x":127,"y":279},{"x":129,"y":293},{"x":138,"y":313},{"x":149,"y":329},{"x":158,"y":339},{"x":169,"y":349},{"x":187,"y":362},{"x":206,"y":373},{"x":228,"y":380},{"x":247,"y":384},{"x":271,"y":384},{"x":289,"y":381},{"x":303,"y":381},{"x":318,"y":376},{"x":332,"y":368},{"x":348,"y":359},{"x":362,"y":348},{"x":372,"y":340},{"x":383,"y":331},{"x":393,"y":320},{"x":398,"y":302},{"x":403,"y":282},{"x":405,"y":270},{"x":399,"y":277},{"x":378,"y":289},{"x":354,"y":295},{"x":332,"y":296},{"x":308,"y":296},{"x":271,"y":293},{"x":237,"y":288},{"x":207,"y":287},{"x":186,"y":287},{"x":175,"y":287}]';
      // var points01_lw7 = '[{"x":4,"y":301},{"x":4,"y":301},{"x":5,"y":301},{"x":6,"y":301},{"x":6,"y":302},{"x":7,"y":302},{"x":8,"y":302},{"x":8,"y":302},{"x":9,"y":302},{"x":10,"y":302},{"x":11,"y":303},{"x":12,"y":303},{"x":12,"y":303},{"x":14,"y":304},{"x":14,"y":304},{"x":15,"y":304},{"x":16,"y":304},{"x":16,"y":304},{"x":17,"y":304},{"x":18,"y":304},{"x":18,"y":304},{"x":19,"y":304},{"x":20,"y":304},{"x":20,"y":304},{"x":21,"y":304},{"x":22,"y":305},{"x":22,"y":305},{"x":23,"y":305},{"x":24,"y":305},{"x":24,"y":305},{"x":25,"y":305},{"x":26,"y":305},{"x":26,"y":305},{"x":27,"y":305},{"x":28,"y":305},{"x":28,"y":305},{"x":29,"y":305},{"x":30,"y":305},{"x":30,"y":305},{"x":31,"y":305},{"x":32,"y":305},{"x":32,"y":305},{"x":33,"y":305},{"x":34,"y":305},{"x":34,"y":305},{"x":35,"y":305},{"x":36,"y":305},{"x":36,"y":305},{"x":37,"y":305},{"x":38,"y":305},{"x":38,"y":305},{"x":38,"y":304},{"x":39,"y":304},{"x":40,"y":304},{"x":40,"y":304},{"x":41,"y":304},{"x":42,"y":304},{"x":42,"y":304},{"x":43,"y":304},{"x":44,"y":304},{"x":44,"y":303},{"x":45,"y":303},{"x":46,"y":303},{"x":47,"y":302},{"x":48,"y":302},{"x":48,"y":302},{"x":49,"y":302},{"x":50,"y":302},{"x":50,"y":302},{"x":51,"y":302},{"x":52,"y":302},{"x":52,"y":302},{"x":54,"y":301},{"x":54,"y":301},{"x":55,"y":301},{"x":56,"y":301},{"x":56,"y":300},{"x":57,"y":300},{"x":58,"y":300},{"x":58,"y":300},{"x":58,"y":300},{"x":59,"y":300},{"x":60,"y":300},{"x":60,"y":300},{"x":61,"y":299},{"x":62,"y":299},{"x":62,"y":299},{"x":63,"y":299},{"x":64,"y":298},{"x":64,"y":298},{"x":64,"y":298},{"x":65,"y":298},{"x":66,"y":298},{"x":66,"y":298},{"x":67,"y":297},{"x":68,"y":297},{"x":68,"y":297},{"x":70,"y":296},{"x":72,"y":296},{"x":72,"y":295},{"x":73,"y":295},{"x":74,"y":295},{"x":74,"y":294},{"x":75,"y":294},{"x":76,"y":294},{"x":77,"y":294},{"x":78,"y":294},{"x":78,"y":293},{"x":79,"y":293},{"x":79,"y":292},{"x":80,"y":292},{"x":80,"y":292},{"x":80,"y":292},{"x":81,"y":292},{"x":82,"y":292},{"x":82,"y":292},{"x":83,"y":292},{"x":83,"y":291},{"x":84,"y":291},{"x":84,"y":291},{"x":85,"y":290},{"x":86,"y":290},{"x":86,"y":290},{"x":87,"y":290},{"x":88,"y":290},{"x":88,"y":290},{"x":89,"y":290},{"x":90,"y":289},{"x":91,"y":288},{"x":92,"y":288},{"x":92,"y":288},{"x":92,"y":288},{"x":93,"y":287},{"x":94,"y":287},{"x":94,"y":287},{"x":95,"y":287},{"x":96,"y":286},{"x":96,"y":286},{"x":98,"y":286},{"x":98,"y":286},{"x":100,"y":285},{"x":100,"y":285},{"x":100,"y":284},{"x":101,"y":284},{"x":102,"y":283},{"x":104,"y":283},{"x":104,"y":282},{"x":104,"y":282},{"x":105,"y":282},{"x":106,"y":281},{"x":107,"y":280},{"x":108,"y":280},{"x":108,"y":280},{"x":108,"y":279},{"x":109,"y":279},{"x":109,"y":278},{"x":110,"y":278},{"x":110,"y":278},{"x":111,"y":278},{"x":112,"y":278},{"x":112,"y":278},{"x":113,"y":278},{"x":113,"y":277},{"x":114,"y":276},{"x":114,"y":276},{"x":115,"y":276},{"x":116,"y":276},{"x":116,"y":276},{"x":116,"y":276},{"x":117,"y":276},{"x":117,"y":275},{"x":118,"y":275},{"x":118,"y":275},{"x":119,"y":275},{"x":119,"y":274},{"x":120,"y":274},{"x":120,"y":274},{"x":121,"y":273},{"x":122,"y":273},{"x":122,"y":272},{"x":123,"y":272},{"x":123,"y":271},{"x":124,"y":271},{"x":124,"y":270},{"x":124,"y":270},{"x":125,"y":270},{"x":126,"y":269},{"x":126,"y":268},{"x":126,"y":268},{"x":127,"y":268},{"x":128,"y":268},{"x":128,"y":267},{"x":128,"y":266},{"x":129,"y":266},{"x":130,"y":266},{"x":130,"y":266},{"x":131,"y":266},{"x":131,"y":265},{"x":132,"y":265},{"x":133,"y":264}]';
      // var points2 = '[{"x":4,"y":301},{"x":4,"y":301},{"x":5,"y":301},{"x":6,"y":301},{"x":6,"y":302},{"x":7,"y":302},{"x":8,"y":302},{"x":8,"y":302},{"x":9,"y":302},{"x":10,"y":302},{"x":11,"y":303},{"x":12,"y":303},{"x":12,"y":303},{"x":14,"y":304},{"x":14,"y":304},{"x":15,"y":304},{"x":16,"y":304},{"x":16,"y":304},{"x":17,"y":304},{"x":18,"y":304},{"x":18,"y":304},{"x":19,"y":304},{"x":20,"y":304},{"x":20,"y":304},{"x":21,"y":304},{"x":22,"y":305},{"x":22,"y":305},{"x":23,"y":305},{"x":24,"y":305},{"x":24,"y":305},{"x":25,"y":305},{"x":26,"y":305},{"x":26,"y":305},{"x":27,"y":305},{"x":28,"y":305},{"x":28,"y":305},{"x":29,"y":305},{"x":30,"y":305},{"x":30,"y":305},{"x":31,"y":305},{"x":32,"y":305},{"x":32,"y":305},{"x":33,"y":305},{"x":34,"y":305},{"x":34,"y":305},{"x":35,"y":305},{"x":36,"y":305},{"x":36,"y":305},{"x":37,"y":305},{"x":38,"y":305},{"x":38,"y":305},{"x":38,"y":304},{"x":39,"y":304},{"x":40,"y":304},{"x":40,"y":304},{"x":41,"y":304},{"x":42,"y":304},{"x":42,"y":304},{"x":43,"y":304},{"x":44,"y":304},{"x":44,"y":303},{"x":45,"y":303},{"x":46,"y":303},{"x":47,"y":302},{"x":48,"y":302},{"x":48,"y":302},{"x":49,"y":302},{"x":50,"y":302},{"x":50,"y":302},{"x":51,"y":302},{"x":52,"y":302},{"x":52,"y":302},{"x":54,"y":301},{"x":54,"y":301},{"x":55,"y":301},{"x":56,"y":301},{"x":56,"y":300},{"x":57,"y":300},{"x":58,"y":300},{"x":58,"y":300},{"x":58,"y":300},{"x":59,"y":300},{"x":60,"y":300},{"x":60,"y":300},{"x":61,"y":299},{"x":62,"y":299},{"x":62,"y":299},{"x":63,"y":299},{"x":64,"y":298},{"x":64,"y":298},{"x":64,"y":298},{"x":65,"y":298},{"x":66,"y":298},{"x":66,"y":298},{"x":67,"y":297},{"x":68,"y":297},{"x":68,"y":297},{"x":70,"y":296},{"x":72,"y":296},{"x":72,"y":295},{"x":73,"y":295},{"x":74,"y":295},{"x":74,"y":294},{"x":75,"y":294},{"x":76,"y":294},{"x":77,"y":294},{"x":78,"y":294},{"x":78,"y":293},{"x":79,"y":293},{"x":79,"y":292},{"x":80,"y":292},{"x":80,"y":292},{"x":80,"y":292},{"x":81,"y":292},{"x":82,"y":292},{"x":82,"y":292},{"x":83,"y":292},{"x":83,"y":291},{"x":84,"y":291},{"x":84,"y":291},{"x":85,"y":290},{"x":86,"y":290},{"x":86,"y":290},{"x":87,"y":290},{"x":88,"y":290},{"x":88,"y":290},{"x":89,"y":290},{"x":90,"y":289},{"x":91,"y":288},{"x":92,"y":288},{"x":92,"y":288},{"x":92,"y":288},{"x":93,"y":287},{"x":94,"y":287},{"x":94,"y":287},{"x":95,"y":287},{"x":96,"y":286},{"x":96,"y":286},{"x":98,"y":286},{"x":98,"y":286},{"x":100,"y":285},{"x":100,"y":285},{"x":100,"y":284},{"x":101,"y":284},{"x":102,"y":283},{"x":104,"y":283},{"x":104,"y":282},{"x":104,"y":282},{"x":105,"y":282},{"x":106,"y":281},{"x":107,"y":280},{"x":108,"y":280},{"x":108,"y":280},{"x":108,"y":279},{"x":109,"y":279},{"x":109,"y":278},{"x":110,"y":278},{"x":110,"y":278},{"x":111,"y":278},{"x":112,"y":278},{"x":112,"y":278},{"x":113,"y":278},{"x":113,"y":277},{"x":114,"y":276},{"x":114,"y":276},{"x":115,"y":276},{"x":116,"y":276},{"x":116,"y":276},{"x":116,"y":276},{"x":117,"y":276},{"x":117,"y":275},{"x":118,"y":275},{"x":118,"y":275},{"x":119,"y":275},{"x":119,"y":274},{"x":120,"y":274},{"x":120,"y":274},{"x":121,"y":273},{"x":122,"y":273},{"x":122,"y":272},{"x":123,"y":272},{"x":123,"y":271},{"x":124,"y":271},{"x":124,"y":270},{"x":124,"y":270},{"x":125,"y":270},{"x":126,"y":269},{"x":126,"y":268},{"x":126,"y":268},{"x":127,"y":268},{"x":128,"y":268},{"x":128,"y":267},{"x":128,"y":266},{"x":129,"y":266},{"x":130,"y":266},{"x":130,"y":266},{"x":131,"y":266},{"x":131,"y":265},{"x":132,"y":265},{"x":133,"y":264}]';
      var points2Parsed = JSON.parse(points2);
      console.log(`points2Parsed: `, points2Parsed);
      var canvas = document.getElementById("canvas");
      var ctx = canvas.getContext("2d");

      var cw = canvas.width;
      var ch = canvas.height;
      function reOffset() {
        var BB = canvas.getBoundingClientRect();
        offsetX = BB.left;
        offsetY = BB.top;
      }
      var offsetX, offsetY;
      reOffset();
      window.onscroll = function (e) {
        reOffset();
      };
      window.onresize = function (e) {
        reOffset();
      };

      ctx.strokeStyle = 'white';
      ctx.lineWidth = 800;
      lineSegment({x: 0, y: 0}, {x: 512, y: 512});
      ctx.strokeStyle = 'black';
      ctx.lineWidth = 5;

      var imgData = ctx.createImageData(512, 512);

      var i;
      for (i = 0; i < imgData.data.length; i += 4) {
        imgData.data[i+0] = 255;
        imgData.data[i+1] = 255;
        imgData.data[i+2] = 255;
        imgData.data[i+3] = 255;
      }

      ctx.putImageData(imgData, 0, 0);

      var isDown = false;
      var points = points2Parsed;
      var nextTime = 0;
      var nextN = 0;
      var duration = 1000 / 60;
      ctx.lineCap = "round";

      // canvas.addEventListener('mousedown', function (e) {
      //   handleMouseDown(e);
      // });
      // canvas.addEventListener('mousemove', function (e) {
      //   handleMouseMove(e);
      // });
      // canvas.addEventListener('mouseup', function (e) {
      //   handleMouseUpOut(e);
      // });
      // canvas.addEventListener('mouseout', function (e) {
      //   handleMouseUpOut(e);
      // });

      var draw = document.getElementById('fast');
      draw.addEventListener('click', function () {
        duration = 1000 / 10;
        beginRedrawing();
      });

      function beginRedrawing() {
        if (points.length < 2) {
          return;
        }
        console.log(`points: `, points);
        points = points.filter((el, i) => {
          if (i % 3 === 0) return el;
          else return false;
        });


        console.log(`points: `, points);
        ctx.globalCompositeOperation="destination-out";
        ctx.lineWidth = 40;
        ctx.strokeStyle = "rgba(0,0,0,1)";


        nextN = 1;
        // ctx.lineWidth = 3;
        // ctx.strokeStyle = 'red';
        requestAnimationFrame(redraw);
      }

      function handleMouseDown(e) {
        // tell the browser we're handling this event
        e.preventDefault();
        e.stopPropagation();
        // get current mouse position
        ctx.lineWidth = 40;
        ctx.strokeStyle = "rgba(0,0,0,1)";
        mouseX = parseInt(e.clientX - offsetX);
        mouseY = parseInt(e.clientY - offsetY);
        points.push({ x: mouseX, y: mouseY });
        // Set dragging flag
        isDown = true;
      }

      function handleMouseUpOut(e) {
        // tell the browser we're handling this event
        e.preventDefault();
        e.stopPropagation();
        // get current mouse position
        mouseX = parseInt(e.clientX - offsetX);
        mouseY = parseInt(e.clientY - offsetY);
        // Clear dragging flag
        isDown = false;
        console.log(`points: `, points);
        points = points.filter((el, i) => {
          if (i % 8 === 0) return el;
          else return false;
        });
        console.log(points);
      }

      function handleMouseMove(e) {
        if (!isDown) {
          return;
        }
        // tell the browser we're handling this event
        e.preventDefault();
        e.stopPropagation();
        // get current mouse position
        ctx.globalCompositeOperation="destination-out";

        mouseX = parseInt(e.clientX - offsetX);
        mouseY = parseInt(e.clientY - offsetY);
        points.push({ x: mouseX, y: mouseY });
        var n = points.length - 1;
        lineSegment(points[n - 1], points[n]);

        // ctx.arc(mouseX,mouseY,1,0,Math.PI*2,false);
        // ctx.fill();
      }

      function lineSegment(p0, p1) {
        ctx.beginPath();
        ctx.moveTo(p0.x, p0.y);
        ctx.lineTo(p1.x, p1.y);
        // ctx.curve([p1.x, p1.y], -2, 25);
        ctx.stroke();
      }

      function bezierCurveTo(bezierDots) {
        ctx.beginPath();
        ctx.moveTo(bezierDots[0], bezierDots[1]);
        ctx.bezierCurveTo(...bezierDots);
        ctx.stroke();
      }

      function redraw(time) {
        if (nextN > points.length - 1) {
          return;
        }
        if (time < nextTime) {
          requestAnimationFrame(redraw);
          return;
        }
        nextTime = time + duration;
        lineSegment(points[nextN - 1], points[nextN]);
        nextN++;
        requestAnimationFrame(redraw);
      }

      function redraw2(time) {
        if (nextN + 3 > points.length - 1) {
          return;
        }
        if (time < nextTime) {
          requestAnimationFrame(redraw2);
          return;
        }
        nextTime = time + duration;
        var curvePoints = points.splice(0,3);
        var pointsTulips = []
        curvePoints.forEach(function (el) {
          pointsTulips.push(el.x, el.y);
        });
        bezierCurveTo(pointsTulips);
        nextN++;
        requestAnimationFrame(redraw2);
      }

      window.addEventListener("load", function () {
        console.log(`1111: `, 1111);
        // draw.click();
      });
    </script>
  </body>
</html>
